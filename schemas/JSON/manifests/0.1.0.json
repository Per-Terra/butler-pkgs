{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://raw.githubusercontent.com/Per-Terra/butler-pkgs/main/schemas/JSON/manifests/0.1.0.json",
  "title": "BUtler Package Manifest v0.1.0",
  "definitions": {
    "Identifier": {
      "type": "string",
      "pattern": "^[0-9A-Za-z]+(?:[+\\-.][0-9A-Za-z]+)*$"
    },
    "DisplayName": {
      "type": "string",
      "pattern": "^\\S(?:.*\\S)?$"
    },
    "FullDate": {
      "type": "string",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
    },
    "Section": {
      "type": "string",
      "enum": [
        "Core",
        "Plugin/Filter",
        "Plugin/Input",
        "Plugin/Output",
        "Plugin/Color",
        "Plugin/Language",
        "Plugin/Other",
        "Script"
      ]
    },
    "Architecture": {
      "type": "string",
      "enum": [
        "x86",
        "x64"
      ]
    },
    "PackageRelationship": {
      "type": "string",
      "pattern": "^([0-9A-Za-z]+(?:[+\\-.][0-9A-Za-z]+)*)(?: *\\((<<|<=|=|>=|>>) *([0-9A-Za-z]+(?:[+\\-.][0-9A-Za-z]+)*)\\))?$"
    },
    "Url": {
      "type": "string",
      "pattern": "^https?://.+$"
    },
    "Path": {
      "type": "string",
      "pattern": "^[^\"*/:<>?\\\\|]+(?:/[^\"*/:<>?\\\\|]+)*$"
    },
    "FileName": {
      "type": "string",
      "pattern": "^[^\"*/:<>?\\\\|]+$"
    },
    "SHA256": {
      "type": "string",
      "pattern": "^[0-9a-z]{64}$"
    },
    "InstallMethod": {
      "type": "string",
      "enum": [
        "SymbolicLink",
        "Copy"
      ]
    },
    "Install": {
      "type": "object",
      "properties": {
        "TargetPath": {
          "description": "(必須) ファイルのインストール先のパスです。",
          "$ref": "#/definitions/Path"
        },
        "Method": {
          "description": "ファイルのインストール方法です。\n以下のいずれかの値を取ります。\n- SymbolicLink: シンボリックリンクを作成します。\n- Copy: ファイルをコピーします。\nデフォルトはSymbolicLinkです。",
          "$ref": "#/definitions/InstallMethod",
          "default": "SymbolicLink"
        }
      },
      "required": [
        "Path"
      ]
    },
    "FileInArchive": {
      "type": "object",
      "properties": {
        "Path": {
          "description": "(必須) アーカイブ内のファイルのパスです。",
          "$ref": "#/definitions/Path"
        },
        "SHA256": {
          "description": "(必須) ファイルのSHA256ハッシュです。",
          "$ref": "#/definitions/SHA256"
        },
        "Files": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/FileInArchive"
          }
        },
        "Install": {
          "$ref": "#/definitions/Install"
        }
      },
      "required": [
        "Path",
        "SHA256"
      ],
      "anyOf": [
        {
          "oneOf": [
            {
              "required": [
                "Files"
              ]
            },
            {
              "required": [
                "Install"
              ]
            }
          ]
        },
        {
          "not": {
            "required": [
              "Files",
              "Install"
            ]
          }
        }
      ]
    },
    "File": {
      "type": "object",
      "properties": {
        "SourceUrl": {
          "description": "(必須) ファイルのダウンロード元のURLです。",
          "$ref": "#/definitions/Url"
        },
        "FileName": {
          "description": "ファイルの名前です。\nSourceUrlの末尾にファイル名が含まれている場合は省略可能です。",
          "$ref": "#/definitions/FileName"
        },
        "SHA256": {
          "description": "(必須) ファイルのSHA256ハッシュです。",
          "$ref": "#/definitions/SHA256"
        },
        "Files": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/FileInArchive"
          }
        },
        "Install": {
          "$ref": "#/definitions/Install"
        }
      },
      "required": [
        "SourceUrl",
        "SHA256"
      ],
      "oneOf": [
        {
          "required": [
            "Install"
          ]
        },
        {
          "required": [
            "Files"
          ]
        }
      ]
    }
  },
  "type": "object",
  "properties": {
    "Identifier": {
      "description": "(必須) パッケージごとに一意に与えられる識別子です。\n英数字と記号(+-.)のみで構成されます。\n大文字と小文字の両方が使えますが、これらは区別されません。\n記号を連続して使うことはできません。",
      "$ref": "#/definitions/Identifier"
    },
    "DisplayName": {
      "description": "パッケージの表示名です。\nIdentifierと同じ場合は省略可能です。",
      "$ref": "#/definitions/DisplayName"
    },
    "Version": {
      "description": "(必須) パッケージのバージョンです。\n英数字と記号(+-.)のみで構成されます。\n記号を連続して使うことはできません。",
      "$ref": "#/definitions/Identifier"
    },
    "ReleaseDate": {
      "description": "パッケージのリリース日です。\nパッケージマニフェストの作成日を示すものではありません。",
      "$ref": "#/definitions/FullDate"
    },
    "Section": {
      "description": "(必須) パッケージの種類です。\n以下のいずれかの値を取ります。\n- Core\n- Plugin/Filter\n- Plugin/Input\n- Plugin/Output\n- Plugin/Color\n- Plugin/Language\n- Plugin/Other\n- Script",
      "$ref": "#/definitions/Section"
    },
    "Architecture": {
      "description": "(必須) パッケージが対応するアーキテクチャです。\nx86とx64のいずれかの値を取ります。\n通常はx86を指定します。",
      "$ref": "#/definitions/Architecture",
      "default": "x86"
    },
    "Depends": {
      "description": "このパッケージが完全に依存するパッケージです。\nパッケージは、このフィールドに列挙されたパッケージがすべてインストールされていなければインストールできません。",
      "type": "array",
      "items": {
        "$ref": "#/definitions/PackageRelationship"
      }
    },
    "Recommends": {
      "description": "このパッケージが強く依存するパッケージです。\nパッケージは、このフィールドに列挙されたパッケージがインストールされていなくてもインストールできますが、理由がない限りインストールすることが推奨されます。",
      "type": "array",
      "items": {
        "$ref": "#/definitions/PackageRelationship"
      }
    },
    "Suggests": {
      "description": "インストールされているとより便利になるパッケージです。\nこのフィールドに列挙されたパッケージによってこのパッケージの有用性が(おそらく)向上するけれども、これらをインストールしない選択もまた完全に合理的であることを示します。",
      "type": "array",
      "items": {
        "$ref": "#/definitions/PackageRelationship"
      }
    },
    "Enhances": {
      "description": "このパッケージが有用性を向上させるであろうパッケージです。\nSuggestsに似ていますが、逆向きに作用します。",
      "type": "array",
      "items": {
        "$ref": "#/definitions/PackageRelationship"
      }
    },
    "Breaks": {
      "description": "このパッケージが破壊するパッケージです。\nパッケージは、このフィールドに列挙されたパッケージがインストールされているとインストールできません。",
      "type": "array",
      "items": {
        "$ref": "#/definitions/PackageRelationship"
      }
    },
    "Conflicts": {
      "description": "このパッケージが競合するパッケージです。\nパッケージは、このフィールドに列挙されたパッケージがインストールされているとインストールできません。",
      "type": "array",
      "items": {
        "$ref": "#/definitions/PackageRelationship"
      }
    },
    "Provides": {
      "description": "このパッケージが提供する仮想パッケージです。\nこのフィールドに列挙されたパッケージはインストールされているものとして扱われ、依存関係を満たしたり競合したりするようになります。",
      "type": "array",
      "items": {
        "$ref": "#/definitions/PackageRelationship"
      }
    },
    "Replaces": {
      "description": "このパッケージによってファイルが上書きされる、または完全に置き換えられるパッケージです。\n既に他のパッケージによって提供されているファイルを上書きすることは通常できませんが、このフィールドに列挙されたパッケージによって提供されているファイルは上書きすることができます。",
      "type": "array",
      "items": {
        "$ref": "#/definitions/PackageRelationship"
      }
    },
    "InstalledSize": {
      "description": "パッケージのインストールに必要なディスク容量です。\n単位はKiBです。",
      "type": "integer",
      "minimum": 0
    },
    "Developer": {
      "description": "(必須) パッケージの開発者です。\n一般的な意味でのメンテナーも含みます。\nパッケージマニフェストの作成者は含みません。",
      "type": "array",
      "items": {
        "$ref": "#/definitions/Identifier"
      }
    },
    "Description": {
      "description": "(必須) パッケージの説明です。\n一行目にはパッケージの概要を、二行目以降はパッケージの詳細を記述します。",
      "type": "string"
    },
    "Website": {
      "description": "パッケージのウェブサイトのURLです。\nパッケージを入手できたり、パッケージの詳細を知ることができるウェブサイトのURLを指定します。",
      "type": "array",
      "items": {
        "type": "string",
        "$ref": "#/definitions/Url"
      }
    },
    "Files": {
      "description": "パッケージに含まれるファイルです。\nパッケージがファイルを含まない場合（メタパッケージなど）は省略可能です。",
      "type": "array",
      "items": {
        "$ref": "#/definitions/File"
      }
    },
    "ConfFiles": {
      "description": "パッケージに含まれる、またはパッケージによって生成される設定ファイルです。\nこのフィールドに列挙されたファイルは、ユーザーが望まない限り上書きされません。\nまた、通常のアンインストール時には削除されません。",
      "type": "array",
      "items": {
        "$ref": "#/definitions/Path"
      }
    },
    "ManifestVersion": {
      "description": "(必須) パッケージマニフェストのバージョンです。",
      "type": "integer",
      "minimum": 0,
      "maximum": 0,
      "default": 0
    }
  },
  "required": [
    "Identifier",
    "Version",
    "Section",
    "Architecture",
    "Developer",
    "Description",
    "ManifestVersion"
  ]
}
